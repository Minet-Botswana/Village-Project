{% extends 'insurance/adminbase.html' %}
{% block content %}
{% load static %}

<!-- Move the head content to the base template if it's not already there -->
{% block extra_head %}
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
{% endblock extra_head %}

<!-- Add SweetAlert library -->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<!-- Add DataTables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">

<!-- Add DataTables JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<style media="screen">
  a:link {
    text-decoration: none;
  }
  h6 {
    text-align: center;
    font-family: "Titillium Web", sans-serif;
  }
  .panel-heading h6 {
    background-color: #e21a22 !important;
    color: white !important; /* Adjust text color for better visibility */
    border: 1px solid #e21a22!important;
  }
  .btn-primary {
    color: #fff;
    background-color: #e21a22;
    border-color: #e21a22;
  }
  .content {
    margin-left: 250px;
    background-color: #fff;
    background-position: center;
    background-size: cover;
    height: 100vh;
    transition: 0.5s;
    font-family: "Titillium Web", sans-serif;
    font-size: small;
  }
  .btn-danger {
    color: #fff;
    background-color: #e21a22;
    border-color: #e21a22;
  }
  .panel-primary>.panel-heading {
    color: #fff;
    background-color: #e21a22;
    border-color: #333;
  }
  .table-container {
    margin-top: 2px; /* Adjust margin as needed */
  }
  .row {
    margin: 10px;
  }
  label #sidebar_btn {
    z-index: 1;
    color: #fff;
    position: fixed;
    cursor: pointer;
    left: 300px;
    padding-left: 60px;
    margin-top:15px;
    font-size: 20px;
    font-family: "Titillium Web", sans-serif;
    transition: 0.5s;
    transition-property: color;
  }
  .breadcrumb {
    font-size: 14px;
    font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif;
    color: #e21a22;
  }
  #dev-table {
    border-spacing: 0 !important; /* Set spacing between table cells to 0 */
  }
  .dataTables_wrapper .dataTables_length select {
    border: 1px solid #aaa;
    border-radius: 3px;
    padding: 5px;
    background-color: transparent;
    padding: 4px;
    margin-top: 4px;
    margin-left: 7px;
  }
  .dataTables_wrapper .dataTables_filter input {
    border: 1px solid #aaa;
    border-radius: 3px;
    padding: 5px;
    background-color: transparent;
    margin-left: 3px;
    margin-top: 4px;
    margin-right: 12px;
  }
  label {
    display: inline-block;
    margin-bottom: 5px;
    font-weight: bold;
    margin-left: 10px;
  }
  .alert-messages {
    background-color: rgb(7, 253, 7);
    color: #721c24;
    padding: 10px 20px;
    border-radius: 5px;
    margin-bottom: 20px;
  }
  .messages {
    list-style: none;
    padding: 0;
    margin: 0;
  }
  .messages li {
    margin-bottom: 5px;
  }
  
</style>

<!-- DataTables initialization script -->
<script>
    $(document).ready(function() {
        $('#dev-table').DataTable();
    });

    // Function to confirm deletion using SweetAlert
    function confirmDelete(url) {
        swal({
            title: "Are you sure?",
            text: "Once deleted, you will not be able to recover this user!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
        })
        .then((willDelete) => {
            if (willDelete) {
                window.location.href = url; // Redirect to delete URL if confirmed
            } else {
                swal("User deletion canceled!");
            }
        });
    }
</script>

<div class="container-fluid">
  <!-- Add the following paragraph to display the page route -->
  <div class="row">
    <div class="col-md-12">
      <p class="breadcrumb" style="font-size: 14px; font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif; color: #e21a22;">
        Home / Clients
      </p>
    </div>
  </div>

</div>

<!-- Add Chart.js library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- DJANGO MESSAGES FOR WRITING MESSAGES HERE-->
<br>


<div class="table-responsive container-fluid">
  <div class="panel panel-primary panel-default">
    <div class="panel-heading">
      <h6 class="panel-title">Clients</h6>
    </div>
    <table class="table table-hover" id="dev-table">
      <thead>
        <tr>
          <th>Name</th>
          <th>Mobile</th>
          <th>ID No.</th>
          <th>Email</th>
          <th>Update</th>
          <th>Delete</th>
        </tr>
      </thead>
      {% for t in customers %}
      <tr>
        <td>{{ t.get_name }}</td>
        <td>{{ t.mobile }}</td>
        <td>{{ t.id_number }}</td>
        <td>{{ t.address }}</td>
        <td><a class="btn btn-primary btn-xs" href="{% url 'update-customer' t.id  %}"><span class="glyphicon glyphicon-edit"></span></a></td>
        <td><button class="btn btn-danger btn-xs" onclick="confirmDelete('{% url 'delete-customer' t.id  %}')"><span class="glyphicon glyphicon-trash"></span></button></td>
      </tr>
      {% endfor %}
     
    </table>
  </div>
</div>

<!-- Add Chart.js library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<div class="container-fluid">
  <!-- Add the following paragraph to display the page route -->
  <div class="row">
    <div class="col-md-12">
      <p class="breadcrumb" style="font-size: 16px; font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif; color: #e21a22;">
        Demographic Overview Analysis
      </p>
    </div>
  </div>
</div>

<!-- Pie chart container -->
<div class="container-fluid">
  <div class="row">
    <div class="col-md-6">
      <p class="breadcrumb" style="font-size: 14px; font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif; color: #e21a22;">
        Demographic Breakdown by Genders
      </p>
      <div class="text-center">
        <span class="badge" style="background-color: #FF6384;">Other</span>
        <span class="badge" style="background-color: #36A2EB;">Male</span>
        <span class="badge" style="background-color: #4ad122;">Female</span>
      </div>
      <div class="pie-chart-container">
        <!-- Add canvas element for the pie chart with reduced dimensions -->
        <canvas id="genderPieChart" width="300" height="300"></canvas>
      </div>
      </div>

    <!-- Bar chart container -->
    <div class="col-md-6">
      <p class="breadcrumb" style="font-size: 14px; font-family: 'Segoe UI', 'Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif; color: #e21a22;">
        Marital Status Distribution
      </p>
      <div class="text-center">
        <span class="badge" style="background-color: #FF6384;">Married</span>
        <span class="badge" style="background-color: #36A2EB;">Divorced</span>
        <span class="badge" style="background-color: #FFCE56;">Single</span>
        <span class="badge" style="background-color: #000000;">Widowed</span>
      </div>
      <div class="bar-chart-container">
        <!-- Add canvas element for the bar chart with reduced dimensions -->
        <canvas id="maritalStatusBarChart" width="300" height="300"></canvas>
      </div>
    </div>
  </div>
</div>

<script>
  // Get gender distribution data from Django view
  var genderData = {{ gender_percentage_json|safe }};

  // Extract labels and data for the pie chart
  var labels = Object.keys(genderData);
  var data = Object.values(genderData);

  // Set colors for different genders
  var colors = ['#FF6384', '#36A2EB', '#FFCE56']; // You can customize colors as needed

  // Initialize pie chart
  var ctxPie = document.getElementById('genderPieChart').getContext('2d');
  var pieChart = new Chart(ctxPie, {
    type: 'pie',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: colors
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false, // Set to false to allow specifying custom dimensions
      legend: {
        display: true,
        position: 'left' // Position of the legend
      },
      layout: {
        padding: {
          left: 2,
          right: 10,
          top: 10,
          bottom: 10
        }
      },
      // Adjust the size of the pie chart
      elements: {
        arc: {
          borderWidth: 0
        }
      },
      // Set the radius of the pie chart
      radius: '90%'
    }
  });

  // Get marital status distribution data from Django view
  var maritalStatusData = {{ marital_status_counts_json|safe }};

  // Extract labels and data for the bar chart
  var labels = Object.keys(maritalStatusData);
  var data = Object.values(maritalStatusData);

  // Set colors for the bar chart
  var colors = ['#FF6384', '#36A2EB', '#FFCE56', '#000000']; // You can customize colors as needed

  // Initialize bar chart
  var ctxBar = document.getElementById('maritalStatusBarChart').getContext('2d');
  var barChart = new Chart(ctxBar, {
    type: 'bar',
    data: {
      labels: labels,
      datasets: [{
        data: data,
        backgroundColor: colors
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false, // Set to false to allow specifying custom dimensions
      legend: {
        display: false // Hide legend for bar chart
      },
      layout: {
        padding: {
          left: 10,
          right: 10,
          top: 10,
          bottom: 10
        }
      },
      // Set the scales for x and y axes
      scales: {
        xAxes: [{
          gridLines: {
            display: false // Hide grid lines for x axis
          },
          ticks: {
            beginAtZero: true // Start y axis at zero
          }
        }],
        yAxes: [{
          gridLines: {
            display: false // Hide grid lines for y axis
          }
        }]
      }
    }
  });
</script>



{% endblock content %}
